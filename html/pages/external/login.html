{{ define "content" }}
<style>
    .bg-image {
        position: absolute;
        top: 20%;
        left: 20%;
        width: 100% !important;
        height: 100% !important;
        background-image: url("/assets/img/elements/background.png");
        background-repeat: no-repeat;
        background-attachment: fixed;
        animation: background-animation-1 5s infinite;
        z-index: -2;
    }
</style>

<div class="bg-image"></div>

<section class="is-vhcentered">
    <div class="column is-4-tablet is-4-widescreen">
        <div class="columns mt-3 is-centered">
            <div class="column is-11 has-text-centered">
                <h1 class="title mb-5">
                    Entre em sua nova casa
                </h1> 
            </div>
        </div>

        <form method="POST" action="/v1/login">
            <div class="field">
                <input name="email" class="input" type="text" placeholder="Email" required>
            </div>

            <div class="field">
                <input name="password" class="input" type="password" placeholder="Senha" required>
            </div>

            <div class="field level-right">
                <button class="button is-primary animate">
                    <b>Login</b>
                </button>
            </div>
        </form>

        <div class="alert is-danger mt-5 d-hidden" id="notification">
            Some text to make the notification bigger
        </div>
    </div>
</section>

{{ end }}

{{ define "script" }}
    <script>
        'use strict'


        let left = $(".navbar-start")
        let right = $(".navbar-end")

        left.html("")
        right.html("")

        var notification = $('#notification')

        $("form").submit(e => {
            e.preventDefault()
            notification.addClass('d-hidden')

            var email = $('[name=email]').val()
            var password = $('[name=password]').val()

            const params = new URLSearchParams()
            params.append('email', email)
            params.append('password', password)

            var request = axios.post('/v1/login', params)

            request.then(response => {
                if (response.data.Content != null) {
                    if (response.data.Content.Code != null) {
                        switch (response.data.Content.Code) {
                        case errorNotAuthorized:
                            notification.text("Email ou senha incorretos.")
                            notification.removeClass('d-hidden')
                        default:
                        }
                    } else {
                        window.location.replace("/homepage")
                    }
                }
            })

            request.catch(error => {
                notification.text("Falha de login, tente novamente mais tarde."
                    + " A causa foi " + error)
                notification.removeClass('d-hidden')

                console.log(error)
            })
        })
    </script>
{{ end }}