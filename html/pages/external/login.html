{{ define "content" }}
<section class="" style="height:90vh; display: flex; align-items: center; justify-content: center;">
    <div class="column is-4-tablet is-4-widescreen">
        <div class="columns mt-3 is-centered">
            <div class="column is-11 has-text-centered">
                <h1 class="title mb-5">
                    Entre em sua nova casa
                </h1> 
            </div>
        </div>

        <form method="POST" action="/v1/login">
            <div class="columns is-centered">
                <div class="column is-full-width">
                    <input name="email" class="input" type="text" placeholder="Email" required>
                </div>
            </div>
            <div class="columns is-centered">
                <div class="column is-full-width">
                    <input name="password" class="input" type="password" placeholder="Senha" required>
                </div>
            </div>

            <div class="columns">
                <div class="column">
                    <button class="button is-pulled-right is-primary animate">
                        <b>Login</b>
                    </button>
                </div>
            </div>
        </form>
    </div>
</section>

{{ end }}

{{ define "script" }}
    <script>
        'use strict'


        let left = $(".navbar-start")
        let right = $(".navbar-end")

        left.html("")
        right.html("")

        $("form").submit(e => {
            e.preventDefault()

            var email = $('[name=email]').val()
            var password = $('[name=password]').val()

            const params = new URLSearchParams()
            params.append('email', email)
            params.append('password', password)

            var request = axios.post('/v1/login', params)

            request.then(response => {
                if (response.data.Content != null) {
                    if (response.data.Content.Code != null) {
                        switch (response.data.Content.Code) {
                        case errorNotAuthorized:
                            window.alert("Email ou senha incorretos")
                        default:
                        }
                    } else {
                        window.location.replace("/homepage")
                    }
                }
            })

            request.catch(error => {
                window.alert("Falha de login, tente novamente mais tarde")
                console.log(error)
            })
        })
    </script>
{{ end }}